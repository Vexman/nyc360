@use "sass:color";

// --- Design Tokens ---
$primary: #0A3D85;
$bg-main: #f3f4f6;
$white: #ffffff;
$text-dark: #1f2937;
$text-gray: #6b7280;
$border: #e5e7eb;
$radius-lg: 16px;
$radius-md: 10px;
$shadow-card: 0 2px 5px rgba(0, 0, 0, 0.04);

// --- Layout ---
.home-container {
  background-color: $bg-main;
  min-height: 100vh;
  padding: 10px 20px 20px 20px; 
  font-family: 'Segoe UI', system-ui, sans-serif;
}

// 1. Sticky Category Header
.category-sticky-header {
  position: sticky; top: 0; z-index: 100; margin-bottom: 20px;
  background: $bg-main; padding: 5px 0;

  .category-scroll-container {
    display: flex; gap: 12px; overflow-x: auto; padding: 4px; width: 100%;
    &::-webkit-scrollbar { height: 4px; display: block; }
    &::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }

    .cat-pill {
      flex: 0 0 auto; background: $white; border: 1px solid transparent;
      padding: 8px 20px; border-radius: 50px; font-size: 0.9rem; font-weight: 600;
      color: $text-gray; display: flex; align-items: center; gap: 8px; cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.03); transition: 0.2s;

      i { font-size: 1.1rem; color: $primary; }
      &:hover { transform: translateY(-2px); color: $primary; }
      &.active { background: $primary; color: $white; i { color: $white; } }
    }
  }
}

// --- Main Grid ---
.main-layout {
  display: grid; grid-template-columns: 280px 1fr 300px; gap: 24px;
  max-width: 1450px; margin: 0 auto;
}

// --- Widget Card Style ---
.widget-card {
  background: $white; border-radius: $radius-lg; box-shadow: $shadow-card;
  border: 1px solid $border; overflow: hidden; margin-bottom: 20px; padding: 16px;
}

// 2. Sidebars Styles
.sidebar {
  position: sticky; top: 90px; height: fit-content; max-height: calc(100vh - 100px);
  overflow-y: auto;
  &::-webkit-scrollbar { display: none; }

  // Profile Widget
  .profile-widget {
    padding: 0;
    .profile-header { height: 70px; background: linear-gradient(135deg, $primary, color.scale($primary, $lightness: 20%)); }
    .profile-content {
      padding: 0 16px 16px; margin-top: -40px; 
      display: flex; flex-direction: column; align-items: center;

      // New Icon Style
      .avatar-icon-wrapper {
        width: 80px; height: 80px; background: $white; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        border: 4px solid $white; color: $text-gray;
        i { font-size: 3.5rem; color: #9ca3af; } // لون رمادي للأيقونة
      }
      
      .user-name { font-size: 1.1rem; font-weight: 700; color: $text-dark; margin: 10px 0 0; }
      .user-role { font-size: 0.85rem; color: $text-gray; }
      .btn-login-sm { margin-top: 10px; background: $primary; color: $white; padding: 6px 20px; border-radius: 20px; text-decoration: none; font-size: 0.85rem; font-weight: 600; }
      
      .stats-row {
        width: 100%; display: flex; justify-content: space-around; margin-top: 20px; padding-top: 15px; border-top: 1px solid $border;
        .stat { display: flex; flex-direction: column; align-items: center; font-size: 0.8rem; color: $text-gray; strong { font-size: 1rem; color: $text-dark; } }
      }
    }
  }

  // Nav Widget
  .nav-widget {
    padding: 10px;
    .side-nav {
      display: flex; flex-direction: column; gap: 5px;
      .nav-item {
        display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: $radius-md;
        text-decoration: none; color: $text-gray; font-weight: 600; font-size: 0.95rem; transition: 0.2s;
        &:hover { background: #f8fafc; color: $primary; }
        &.active { background: #eff6ff; color: $primary; border-left: 4px solid $primary; }
        i { font-size: 1.2rem; }
      }
    }
  }

  // Right Sidebar Widgets
  .widget-title { font-size: 0.95rem; font-weight: 700; color: $text-dark; margin-bottom: 15px; display: flex; align-items: center; }
  
  .weather-widget {
    .weather-content {
      display: flex; justify-content: space-between; align-items: center;
      .degree { font-size: 2rem; font-weight: 800; color: $text-dark; }
      .status { font-size: 0.85rem; color: $text-gray; display: block; }
      .aqi-badge { background: #dcfce7; color: #166534; padding: 4px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 700; }
    }
  }

  .tags-list {
    display: flex; flex-wrap: wrap; gap: 8px;
    .trend-tag { background: #f3f4f6; padding: 6px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; color: $text-dark; cursor: pointer; transition: 0.2s; &:hover { background: #e5e7eb; } }
  }

  .community-item {
    display: flex; align-items: center; gap: 10px; margin-bottom: 15px;
    .comm-icon { 
      width: 40px; height: 40px; background: #e0e7ff; color: $primary; 
      border-radius: 10px; display: flex; align-items: center; justify-content: center; 
      font-size: 1.4rem; // Icon size
    }
    .comm-details { flex: 1; h5 { font-size: 0.9rem; font-weight: 700; margin: 0; } small { font-size: 0.75rem; color: $text-gray; } }
    .btn-icon-join { width: 32px; height: 32px; border-radius: 50%; border: 1px solid $border; background: $white; cursor: pointer; display: flex; align-items: center; justify-content: center; &:hover { background: #f3f4f6; } }
  }
}

// 3. Center Feed
.feed-content {
  
  .create-post-widget {
    @extend .widget-card;
    .input-top {
      display: flex; gap: 12px; align-items: center;
      .avatar-icon-sm { font-size: 2.2rem; color: #9ca3af; } // Create post icon style
      .fake-input { flex: 1; height: 44px; background: #f9fafb; border: 1px solid $border; border-radius: 24px; text-align: left; padding: 0 20px; color: $text-gray; cursor: pointer; &:hover { background: #f3f4f6; } }
    }
  }

  .state-widget { @extend .widget-card; text-align: center; padding: 40px; color: $text-gray; .empty-icon { font-size: 3rem; opacity: 0.5; margin-bottom: 10px; display: block; } }

  .post-card {
    @extend .widget-card; padding: 0; animation: fadeInUp 0.5s ease-out;

    .post-header {
      padding: 16px; display: flex; align-items: center; gap: 12px;
      .author-icon-wrapper { 
         color: #6b7280; font-size: 2.4rem; // Author icon style in post
         display: flex; align-items: center;
      }
      .post-meta { flex: 1; .author-name { font-size: 0.95rem; font-weight: 700; color: $text-dark; margin: 0; } .post-time { font-size: 0.8rem; color: $text-gray; } }
      .options-btn { color: $text-gray; font-size: 1.2rem; cursor: pointer; }
    }

    .post-body {
      padding: 0 16px 16px;
      .post-link { text-decoration: none; display: block; &:hover .post-title { color: $primary; } }
      .post-title { font-size: 1.1rem; font-weight: 700; color: $text-dark; margin-bottom: 8px; transition: 0.2s; }
      .post-desc { font-size: 0.95rem; color: #374151; line-height: 1.5; margin-bottom: 12px; }
      .post-media { width: 100%; border-radius: 8px; overflow: hidden; background: #000; display: flex; justify-content: center; img { max-width: 100%; max-height: 550px; object-fit: contain; } }
    }

    .post-footer {
      border-top: 1px solid $border; padding: 4px 16px;
      .interactions {
        display: flex; justify-content: space-between;
        .int-btn {
          flex: 1; background: none; border: none; padding: 10px; border-radius: 6px; color: $text-gray; font-weight: 600; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 6px; cursor: pointer; text-decoration: none; transition: 0.2s;
          &:hover { background: #f3f4f6; }
          &.like.active { color: #e11d48; i { color: #e11d48; } }
          i { font-size: 1.1rem; }
        }
      }
    }
  }
}

// --- Responsive Breakpoints ---
@media (max-width: 1200px) {
  .main-layout { grid-template-columns: 260px 1fr; .right-sidebar { display: none; } }
}

@media (max-width: 768px) {
  .home-container { padding: 5px; } 
  .category-sticky-header { top: 60px; .cat-pill { padding: 8px 16px; font-size: 0.85rem; } }
  .main-layout { grid-template-columns: 1fr; .left-sidebar { display: none; } }
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(15px); }
  to { opacity: 1; transform: translateY(0); }
}